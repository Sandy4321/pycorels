language: python
matrix:
  include:
  - name: Python 3.7 on Windows
    os: windows
    language: shell
    before_install:
    - choco install python make
    - python -m pip install --upgrade pip
    env: PATH=/c/Python37:/c/Python37/Scripts:$PATH
    install: pip3 install pytest corels
    before_script:
    - cd corels/src/corels/src && make -B NGMP=1
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 2.7 on Linux
    python: 2.7
    before_install:
    - pip install --upgrade pip
    - pip install pytest
    install: pip install corels
    before_script:
    - cd corels/src/corels/src && make -B NGMP=1
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 3.7 on Xenial Linux
    python: 3.7
    dist: xenial
    before_install:
    - pip install --upgrade pip
    - pip install pytest
    install: pip install corels
    before_script:
    - cd corels/src/corels/src && make -B NGMP=1
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 2.7 on Linux with GMP
    python: 2.7
    before_install:
    - sudo apt-get install libgmp-dev
    - pip install --upgrade pip
    - pip install pytest
    install: pip install corels
    before_script:
    - cd corels/src/corels/src && make -B
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 3.7 on Xenial Linux with GMP
    python: 3.7
    dist: xenial
    before_install:
    - sudo apt-get install libgmp-dev
    - pip install --upgrade pip
    - pip install pytest
    install: pip install corels
    before_script:
    - cd corels/src/corels/src && make -B
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 2.7 on macOS
    os: osx
    osx_image: xcode10.2
    language: shell
    before_install:
    - pip install --upgrade pip
    - pip install pytest
    install: pip install corels
    before_script:
    - cd corels/src/corels/src && make -B NGMP=1
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 3.7 on macOS
    os: osx
    osx_image: xcode10.2
    language: shell
    before_install:
    - pip3 install --upgrade pip
    - pip3 install pytest
    install: pip3 install corels
    before_script:
    - cd corels/src/corels/src && make -B NGMP=1
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python3 -m pytest
  - name: Python 2.7 on macOS with GMP
    os: osx
    osx_image: xcode10.2
    addons:
      homebrew:
        packages:
        - gmp
    language: shell
    before_install:
    - pip install --upgrade pip
    - pip install pytest
    install: pip install corels
    before_script:
    - cd corels/src/corels/src && make -B
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python -m pytest
  - name: Python 3.7 on macOS with GMP
    os: osx
    osx_image: xcode10.2
    addons:
      homebrew:
        packages:
        - gmp
    language: shell
    before_install:
    - pip3 install --upgrade pip
    - pip3 install pytest
    install: pip3 install corels
    before_script:
    - cd corels/src/corels/src && make -B
    - "./corels -b ../data/compas_test.out ../data/compas_test.label"
    script: cd ../../../../tests && python3 -m pytest
